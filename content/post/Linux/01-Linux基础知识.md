---
title: "1 Linux 基础知识"
date: 2023-01-01T01:01:01+08:00
categories: ["D:"]
tags: ["D:"]
draft: false
---
# 1 Linux 基础知识

## 1.1 Linux 系统架构

### 1.1.1 内核架构

- **内核(Kernel)**：操作系统的核心，是直接与硬件交互的软件层

  - **内存管理**

    - 物理内存管理：负责物理页面的分配和回收
    - 虚拟内存管理：提供进程独立的地址空间
    - 页面置换：在物理内存不足时将数据交换到磁盘
    - 内存映射：支持文件映射和共享内存

  - **进程管理**

    - 进程创建和销毁
    - 进程调度：决定哪个进程获得 CPU 时间
    - 进程间通信(IPC)：管道、信号、共享内存等
    - 线程支持：内核级线程的实现

  - **设备驱动**

    - 字符设备：串口、键盘等
    - 块设备：硬盘、SSD 等
    - 网络设备：网卡等
    - 驱动程序接口：提供统一的设备访问接口

  - **系统调用**

    - 进程控制：fork(), exec(), exit()
    - 文件操作：open(), read(), write()
    - 设备控制：ioctl()
    - 信息维护：getpid(), alarm()
    - 通信：pipe(), shmget()

  - **文件系统**
    - VFS（虚拟文件系统）：提供统一的文件操作接口
    - 支持多种文件系统：ext4, xfs, btrfs 等
    - 文件缓存：提高文件访问性能
    - 权限管理：文件访问控制

### 1.1.2 Shell

- **概念**：用户与内核交互的接口

  - 命令解释器：解析用户输入的命令
  - 脚本执行环境：支持 Shell 脚本编程
  - 环境变量管理：管理系统和用户的环境变量
  - 作业控制：管理前台和后台进程

- **常见 Shell**：

  - **Bash (默认)**

    - 特点：功能强大，脚本编程能力强
    - 命令历史记录
    - 命令补全
    - 别名(alias)支持

  - **Zsh**

    - 更强大的命令补全
    - 拼写纠正
    - 主题支持
    - 插件系统

  - **Fish**

    - 智能的命令建议
    - 语法高亮
    - 基于网页的配置界面

  - **Ksh**
    - POSIX 兼容
    - 性能优秀
    - 企业级应用

## 1.2 Linux 目录结构

Linux 采用树状目录结构，每个目录都有其特定的用途：

- `/bin`：基本命令

  - 存放系统启动和运行必需的命令
  - 所有用户都可以使用
  - 例如：ls, cp, mv 等命令

- `/sbin`：系统管理命令

  - 存放系统管理相关的命令
  - 通常只有 root 用户可以使用
  - 例如：fdisk, ifconfig 等

- `/etc`：配置文件

  - 系统和应用程序的配置文件
  - 例如：/etc/passwd（用户信息）
  - /etc/fstab（文件系统信息）
  - /etc/hosts（主机名映射）

- `/home`：用户目录

  - 普通用户的主目录
  - 每个用户有独立的空间
  - 包含用户的个人文件和配置

- `/root`：root 用户目录

  - 超级用户 root 的主目录
  - 存放 root 用户的个人文件

- `/usr`：应用程序

  - 存放用户安装的应用程序
  - 包含应用程序的可执行文件、库文件等
  - 类似于 Windows 的 Program Files

- `/var`：变化的文件

  - 存放经常变化的文件
  - 日志文件：/var/log
  - 邮件：/var/mail
  - 打印队列：/var/spool

- `/tmp`：临时文件

  - 存放临时文件
  - 系统重启时会清空
  - 所有用户都可以访问

- `/proc`：系统信息
  - 虚拟文件系统
  - 提供系统运行时的信息
  - 进程信息：/proc/[pid]
  - 系统信息：/proc/cpuinfo, /proc/meminfo

## 1.3 常用命令

### 1.3.1 文件操作

```bash
# 文件列表和导航
ls -l       # 详细列表，显示权限、大小、时间等
ls -a       # 显示所有文件，包括隐藏文件
ls -h       # 以人类可读方式显示文件大小
cd ~        # 切换到用户主目录
cd -        # 切换到上一个工作目录
pwd         # 显示当前工作目录的完整路径

# 目录操作
mkdir -p    # 创建多级目录
rmdir       # 删除空目录
rm -r       # 递归删除目录及其内容
rm -f       # 强制删除，不提示

# 文件操作
cp -r       # 递归复制目录
cp -p       # 保留文件属性
mv -i       # 交互式移动/重命名
mv -f       # 强制移动/重命名

# 权限管理
chmod 755   # 设置权限为 rwxr-xr-x
chmod u+x   # 给所有者添加执行权限
chown user:group # 修改所有者和组
```

### 1.3.2 文本操作

```bash
# 文件查看
cat -n      # 显示行号
less        # 分页查看，可前后翻页
head -n 10  # 查看前10行
tail -f     # 实时查看文件末尾

# 文本搜索
grep -i     # 忽略大小写搜索
grep -r     # 递归搜索目录
grep -v     # 反向匹配
grep -n     # 显示行号

# 文本处理
sed 's/old/new/g'    # 替换文本
sed -i               # 直接修改文件
awk '{print $1}'     # 打印第一列
awk -F:             # 指定分隔符
```

### 1.3.3 系统管理

```bash
# 进程管理
ps aux      # 显示所有进程详细信息
ps -ef      # 显示所有进程
top -c      # 显示进程命令行
top -p pid  # 监控特定进程

# 资源使用
df -h       # 显示磁盘使用情况，人类可读格式
du -sh      # 显示目录大小汇总
free -m     # 以MB为单位显示内存使用
free -g     # 以GB为单位显示内存使用
```

## 1.4 用户和权限管理

### 1.4.1 用户管理

```bash
# 用户操作
useradd -m          # 创建用户并创建主目录
useradd -G group    # 创建用户并加入附加组
userdel -r          # 删除用户及其主目录
passwd username     # 设置用户密码

# 权限切换
su - username       # 完全切换到其他用户环境
sudo command        # 以root权限执行命令
sudo -i            # 切换到root用户环境
```

### 1.4.2 权限体系

- **权限类型**：

  - **r (读)**：

    - 文件：允许读取文件内容
    - 目录：允许列出目录内容

  - **w (写)**：

    - 文件：允许修改文件内容
    - 目录：允许创建、删除文件

  - **x (执行)**：
    - 文件：允许执行文件
    - 目录：允许进入目录

- **权限范围**：

  - **u (用户)**：文件所有者
  - **g (组)**：文件所属组
  - **o (其他)**：其他所有用户

- **权限表示方法**：
  - 字符表示：rwxr-xr-x
  - 数字表示：755
    - r = 4
    - w = 2
    - x = 1

## 1.5 面试重点

1. **文件权限**

   - **权限的数字表示方法**：

     - 755：rwxr-xr-x
       - 所有者：rwx (4+2+1 = 7)
       - 组用户：r-x (4+0+1 = 5)
       - 其他用户：r-x (4+0+1 = 5)
     - 644：rw-r--r--
       - 所有者：rw- (4+2+0 = 6)
       - 组用户：r-- (4+0+0 = 4)
       - 其他用户：r-- (4+0+0 = 4)

   - **chmod 命令使用**：
     - chmod u+x file：给所有者添加执行权限
     - chmod g-w file：移除组的写权限
     - chmod o=r file：设置其他用户为只读
     - chmod a+x file：给所有人添加执行权限

2. **进程管理**

   - **ps 命令参数**：

     - ps aux：显示所有进程
     - ps -ef：系统格式显示所有进程
     - ps -u username：显示指定用户的进程
     - ps -p pid：显示指定进程 ID 的进程

   - **kill 命令使用**：

     - kill -9 pid：强制终止进程
     - kill -15 pid：正常终止进程
     - killall process_name：终止指定名称的所有进程
     - pkill pattern：终止匹配模式的进程

   - **进程状态**：
     - R：运行或就绪
     - S：可中断睡眠
     - D：不可中断睡眠
     - Z：僵尸进程
     - T：停止或跟踪

3. **文件系统**

   - **inode 概念**：

     - 存储文件元数据的数据结构
     - 每个文件一个 inode
     - 包含文件的权限、大小、时间戳等信息
     - 通过 inode 号唯一标识文件

   - **硬链接 vs 软链接**：

     - 硬链接：
       - 与原文件共享 inode
       - 只能链接文件
       - 不能跨文件系统
     - 软链接：
       - 创建新的 inode
       - 可以链接目录
       - 可以跨文件系统
       - 类似 Windows 的快捷方式

   - **文件系统类型**：
     - ext4：Linux 默认文件系统
     - xfs：高性能文件系统
     - btrfs：新一代文件系统
     - tmpfs：内存文件系统

4. **系统负载**

   - **load average 的含义**：

     - 1 分钟、5 分钟、15 分钟的平均负载
     - 反映系统繁忙程度
     - 一般不超过 CPU 核心数
     - 超过说明系统压力大

   - **CPU 使用率**：

     - user：用户空间 CPU 使用
     - system：内核空间 CPU 使用
     - iowait：等待 IO 的 CPU 时间
     - idle：空闲 CPU 时间

   - **内存使用情况**：
     - 物理内存使用
     - 交换空间使用
     - 缓存和缓冲区使用
     - 可用内存量

