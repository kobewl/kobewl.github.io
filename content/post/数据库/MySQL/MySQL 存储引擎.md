---
title: "1 MySQL 支持哪些存储引擎？默认使用哪个？"
date: 2023-01-01T01:01:01+08:00
categories: ["D:"]
tags: ["D:"]
draft: false
---
# 1 MySQL 支持哪些存储引擎？默认使用哪个？

在MySQL中，存储引擎是可以自己扩展的，存储引擎的本质就是

- **定义数据的存储方式**
- **数据的读取的实现逻辑**

根据不同的存储引擎的不同特性，使得我们可以针对的选择合适的引擎来实现不同的业务场景，从而去获取更好的性能。

MySQL 支持多种存储引擎，你可以通过 `SHOW ENGINES` 命令来查看 MySQL 支持的所有存储引擎。

从上图我们可以查看出， MySQL 当前默认的存储引擎是 InnoDB。并且，所有的存储引擎中只有 InnoDB 是事务性存储引擎，也就是说只有 InnoDB 支持事务。

MySQL 5.5.5 之前，MyISAM 是 MySQL 的默认存储引擎。5.5.5 版本之后，InnoDB 是 MySQL 的默认存储引擎。

# 2 MySQL常见的存储引擎有哪些？

MySQL常见的存储引擎分别是：InnoDB、MEMORY、MyISAM、ARCHIVE、CSV等等


# 3 MySQL 存储引擎架构了解吗？

MySQL 存储引擎采用的是 **插件式架构** ，支持多种存储引擎，我们甚至可以为不同的数据库表设置不同的存储引擎以适应不同场景的需要。**存储引擎是基于表的，而不是数据库**。

下图展示了具有可插拔存储引擎的 MySQL 架构：


MySQL architecture diagram showing connectors, interfaces, pluggable storage engines, the file system with files and logs.

你还可以根据 MySQL 定义的存储引擎实现标准接口来编写一个属于自己的存储引擎。这些非官方提供的存储引擎可以称为第三方存储引擎，区别于官方存储引擎。像目前最常用的 InnoDB 其实刚开始就是一个第三方存储引擎，后面由于过于优秀，其被 Oracle 直接收购了。

MySQL 官方文档也有介绍到如何编写一个自定义存储引擎，地址：[https://dev.mysql.com/doc/internals/en/custom-engine.htmlopen in new window](https://dev.mysql.com/doc/internals/en/custom-engine.html)

# 4 MyISAM 和 InnoDB 有什么区别？

MyISAM引擎的数据是通过二进制的方式存储在磁盘上，它的磁盘体现分为两个文件，分别**是.MYD文件和.MYI文件**，**D代表data**，存放的是MyISAM的**数据**文件，存放的是数据记录，**I代表index**，存放的是MyISAM的**索引**文件，存放的是索引。

InnoDB引擎的数据同样是存储在磁盘上的，但是磁盘上**只有一个ibd文件**，里面包含索引和数据，在B+树的叶子节点里存储了索引对应的数据。

虽然，MyISAM 的性能还行，各种特性也还不错（比如全文索引、压缩、空间函数等）。但是，MyISAM 不支持事务和行级锁，而且最大的缺陷就是崩溃后无法安全恢复。

### 4.1.1 数据存储方式不同

MyISAM里的数据和索引是分开存储的，InnoDB是把索引和数据存储在同一个文件中。

### 4.1.2 对于事务的支持不同

MyISAM不支持事务，InnoDB是支持一个ACID特性的一个事务处理

### 4.1.3 对于锁的支持不同

MyISAM只支持表锁，InnoDB可以根据不同的情况去支持表锁、行锁、间隙锁、临键锁，默认为行级锁。

### 4.1.4 对于外键的支持不同

MyISAM不支持外键，InnoDB支持外键


# 5 各存储引擎特性对比

## 5.1 InnoDB

### 5.1.1 主要特性
- 支持事务（ACID）和外键
- 行级锁定
- MVCC多版本并发控制
- 支持自动崩溃恢复
- 支持外键约束
- 支持在线热备份

### 5.1.2 适用场景
- 需要事务支持的应用
- 并发要求高的应用
- 需要外键支持的应用
- 需要数据一致性的应用

## 5.2 MyISAM

### 5.2.1 主要特性
- 表级锁定
- 支持全文索引
- 支持数据压缩
- 不支持事务和外键
- 崩溃后不支持安全恢复

### 5.2.2 适用场景
- 读密集的应用
- 需要全文索引的应用
- 数据仓库应用
- 日志系统

## 5.3 Memory（HEAP）

### 5.3.1 主要特性
- 数据存储在内存中
- 支持哈希索引
- 表级锁定
- 不支持BLOB和TEXT字段
- 服务重启后数据丢失

### 5.3.2 适用场景
- 临时表
- 数据缓存
- 会话管理
- 实时查询分析

## 5.4 Archive

### 5.4.1 主要特性
- 高度压缩的未索引表
- 只支持INSERT和SELECT操作
- 行级锁定
- 不支持事务

### 5.4.2 适用场景
- 日志存储
- 数据归档
- 历史数据存储

# 6 存储引擎的选择建议

## 6.1 选择标准

1. **数据一致性要求**
   - 需要事务支持：选择InnoDB
   - 可以容忍数据丢失：考虑MyISAM或Memory

2. **并发访问**
   - 高并发写入：选择InnoDB（行级锁）
   - 以读为主：考虑MyISAM
   - 临时数据：考虑Memory

3. **功能特性需求**
   - 需要外键：选择InnoDB
   - 需要全文索引：选择MyISAM（MySQL 5.6以后InnoDB也支持）
   - 需要数据压缩：选择MyISAM或Archive

4. **内存和存储要求**
   - 内存足够：可以考虑Memory
   - 存储空间受限：考虑Archive
   - 需要持久化：选择InnoDB或MyISAM

## 6.2 性能对比

| 特性 | InnoDB | MyISAM | Memory | Archive |
|------|---------|---------|---------|----------|
| 读取性能 | 较好 | 很好 | 最好 | 一般 |
| 写入性能 | 好 | 一般 | 很好 | 较好 |
| 崩溃恢复 | 支持 | 不支持 | N/A | N/A |
| 并发性能 | 很好 | 一般 | 一般 | 一般 |
| 存储空间 | 较大 | 一般 | 最小 | 最小 |

## 6.3 实际应用场景示例

1. **电商系统**
   - 订单表：InnoDB（需要事务）
   - 商品分类：MyISAM（读多写少）
   - 购物车：Memory（临时数据）
   - 操作日志：Archive（归档数据）

2. **博客系统**
   - 文章表：MyISAM（支持全文索引）
   - 用户表：InnoDB（需要事务）
   - 会话信息：Memory（临时数据）
   - 访问日志：Archive（日志数据）

3. **金融系统**
   - 账户表：InnoDB（强一致性）
   - 交易记录：InnoDB（事务支持）
   - 报表数据：MyISAM（统计分析）
   - 历史数据：Archive（归档）



