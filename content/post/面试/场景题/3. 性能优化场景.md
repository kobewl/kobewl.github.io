---
title: "1 性能优化场景题"
date: 2023-01-01T01:01:01+08:00
categories: ["D:"]
tags: ["D:"]
draft: false
---
# 1 性能优化场景题

## 1.1 API 接口性能优化

### 1.1.1 场景描述

某个 REST API 接口在高并发场景下响应变慢，需要进行优化。

### 1.1.2 核心要求

- 提高接口响应速度
- 优化数据库查询
- 添加适当的缓存
- 控制并发访问

### 1.1.3 优化方案

1. 数据库优化
   - 添加适当索引
   - SQL 语句优化
   - 分库分表
2. 缓存优化
   - 使用 Redis 缓存热点数据
   - 实现多级缓存
   - 合理设置缓存过期时间
3. 并发控制
   - 使用线程池
   - 实现请求限流
   - 添加熔断机制

## 1.2 JVM 性能调优

### 1.2.1 场景描述

Java 应用出现频繁 Full GC，导致系统响应缓慢。

### 1.2.2 核心要求

- 分析 GC 日志
- 优化 JVM 参数
- 解决内存泄漏
- 提高系统稳定性

### 1.2.3 优化方案

1. JVM 参数调优

```bash
# 设置堆内存大小
-Xms4g -Xmx4g
# 设置新生代大小
-Xmn2g
# 设置垃圾收集器
-XX:+UseG1GC
```

2. 代码层面优化

```java
// 使用软引用避免 OOM
SoftReference<byte[]> softRef = new SoftReference<>(new byte[4*1024*1024]);

// 使用 try-with-resources 自动关闭资源
try (FileInputStream fis = new FileInputStream("file.txt")) {
    // 处理文件
}
```

## 1.3 MySQL 查询优化

### 1.3.1 场景描述

数据库查询速度慢，CPU 使用率高。

### 1.3.2 核心要求

- 优化 SQL 语句
- 添加合适索引
- 优化表结构
- 控制查询范围

### 1.3.3 优化方案

1. 索引优化

```sql
-- 添加复合索引
ALTER TABLE users ADD INDEX idx_name_age (name, age);

-- 使用覆盖索引
SELECT id, name, age FROM users WHERE name = 'Tom' AND age > 20;
```

2. SQL 语句优化

```sql
-- 避免使用 SELECT *
SELECT id, name FROM users WHERE age > 20;

-- 使用 LIMIT 限制结果集
SELECT * FROM users LIMIT 100;
```

